/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package number.operations;

import java.math.BigDecimal;
import java.math.BigInteger;
import java.math.RoundingMode;

/**
 *
 * @author anisha
 */
public class ConvertZqToReal {

    static int e = 64;
    static int f = e;
    static BigInteger q = BigInteger.valueOf(2).pow(e + 2 * f + 1).nextProbablePrime();
    static BigInteger pow2f = BigInteger.valueOf(2).pow(f);
        
    public static void main(String[] args) {
        
        System.out.println("prime: "+ q);
        System.out.println("NR round 0:");
        
        joinResults(new String[] {
        "381092610068802584406973",
            "655525725626505690013213",
            "734802066144636553911272",
            "1575246641072329323020781",
            "2072324118121682699925251"
        }, "a1");
        
        joinResults(new String[] {
        "6771973283275681267484894388037798590146728665055772896704",
            "276465331953099769323324984217864465142238227183843883556",
            "2348253087640026179303539481283223518677768835235660120093",
            "502268148162718700397254850537197760366048175157140481137",
            "2655243619741835611162565142339248497871926988049044302265"
        }, "b1");
        
        joinResults(new String[] {
        "2741214959756410068836346090974032616535388638525078560993",
            "2634211760971703028165109428668242837033473159701044286884",
            "10918575110362920659098878069863339456772259531205092512327",
            "4058659876331309163876404252088877037035955237526266709034",
            "4755745234124380135366419851236173717032860294713827077248"
        }, "dp1");
        
        joinResults(new String[] {
        "347249390518647517986017",
            "745779463221282081911520",
            "860472966336463349608816",
            "1490483686392520846825619",
            "2503355950062048068038134"
        }, "a2");
        
        joinResults(new String[] {
        "0",
            "0",
            "0",
            "0",
            "0"
        }, "b2");
        
        joinResults(new String[] {
        "5706835510704780424810098129085335426817957230702659301206",
            "8427892971892456935102213856469666557996050898991419380391",
            "4221950013706383658281677639457813041261329613996025941292",
            "6894519461555602392589652910439276338358260091070505444078",
            "12411412454460861172231094003793907132180534832023597010604"
        }, "dp2");
        
        System.out.println("\nNR round 1:");
        
        joinResults(new String[] {
        "2072324118121682699925251",
            "1575246641072329323020781",
            "734802066144636553911272",
            "655525725626505690013213",
            "381092610068802584406973"
        }, "a1");
        
        joinResults(new String[] {
        "5340432648539767254463821535398862878175756721563451407162",
            "11081681370226746920704296737883155265406326602520346826983",
            "10858005395561805398318605266887475222999465171045664563079",
            "9450702888181761100378787353954161798667776292278718042098",
            "931788109810003909149225645122343331364807882833852009959"
        }, "b1");
        
        joinResults(new String[] {
        "2975911362298598457608436289642074729903437560371039127918",
            "6830199961157718628807163884215987455326836033280959869062",
            "8023624002681003077467879561586637032825144212008161867723",
            "11144183949906399488320476803943935164274828081596747370538",
            "8688691136276364930810779999857364114284902564601261968201"
        }, "dp1");
        
        joinResults(new String[] {
        "2503355950062048068038134",
            "1490483686392520846825619",
            "860472966336463349608816",
            "745779463221282081911520",
            "347249390518647517986017"
        }, "a2");
        
        joinResults(new String[] {
        "11187454397869601369535976652337387985042990124391744534621",
            "1278350403720590013222004847106503563743914210944917241379",
            "2886873233693633168202847393595751745181929464957842308074",
            "1308285814109950484088373377571538950750217474622708984990",
            "8447443092152948020293955422219483419690370502885191895146"
        }, "b2");
        
        joinResults(new String[] {
        "8469814080463822288605365891145291330246208968786795619319",
            "5685114162314550637332053026249068412380212846671340069737",
            "10052725164938926056947362254958402295806695667242381567753",
            "7977036930413393264911428659130018161296576156962355392269",
            "5477920074189392335218526707763218296884421703250106909414"
        }, "dp2");
        
        System.out.println("All other DP:");

         joinResults(new String[] {
        "2975911362298598457608436289642074729903437560371039127918",
             "6830199961157718628807163884215987455326836033280959869062",
             "8023624002681003077467879561586637032825144212008161867723",
             "11144183949906399488320476803943935164274828081596747370538",
             "8688691136276364930810779999857364114284902564601261968201"
        }, "dp1");
         
         joinResults(new String[] {
        "8469814080463822288605365891145291330246208968786795619319",
             "5685114162314550637332053026249068412380212846671340069737",
             "10052725164938926056947362254958402295806695667242381567753",
             "7977036930413393264911428659130018161296576156962355392269",
             "5477920074189392335218526707763218296884421703250106909414"
        }, "dp2");
         
        joinResults(new String[] {
        "4316442088702254457330137054263475389474822153943925395543",
            "8358493288051809324219661302484399553662949750965315457620",
            "9374526228347433333883561345757109262080866452800878376559",
            "460537134327869519307295345851149602332290934606341772889",
            "2598408202117356420602502644474531856858482010232359301579"
        }, "dp3");
        
        joinResults(new String[] {
        "2393881599079736696836472741047879022512573465464562664313",
            "6169027065350840017458398167903392954181393642897533408089",
            "2446064297554877415327726611509751304147966137210314504772",
            "3038992052940808602837880156112445249124722160993738694366",
            "11060441926620460322882680016257197134442754619080033776250"
        }, "dp4");
        
        joinResults(new String[] {
        "8887004526775260521507096732552331277317400353076454253291",
            "3869731342137633258711891420187939358972227672736526663165",
            "8619812042542289725386124264936354239426112343185290893809",
            "5026896846405040508185945382402516762000087749735202262531",
            "11259165654459860569223678739166856858898290406538261476151"
        }, "dp5");

    
        
        joinResults(new String[] {
        "10966533743504682125755584871475622261870874257381725111705",
            "6112278924247350022425577947137864643358738734765872234479",
            "11314313311921451646070044729005506536635274671797464646995",
            "2940192759743219346654827736410872414998880968822195590409",
            "6329291672903381442108701255216132639750341223535524356323"
        }, "dp6");
        
        joinResults(new String[] {
        "6001910225673510587186142864322109089160513499706589777319",
            "11724222682226878757949707941929085620666947108722475742959",
            "6516997723239160589255358982964621928264104739411257706683",
            "672766407288603580266014463429646015898163265169123812913",
            "192509903118569540685933440185203010419662914324132847614"
        }, "dp7");

        joinResults(new String[] {
        "2501505156357069412015175965260934070413938829458070784564",
            "5272776825374705097072797396297383085297057689176370396381",
            "11205038155039652686466654075182486984096021271876460595671",
            "4051394630742969418453913331544668666094034319106908271416",
            "2077692174032326441334616924545192858508337782958510993934"
        }, "dp8");
 
        joinResults(new String[] {
        "6029330979016809404693063204253730028542035194666248244948",
            "12327831989623964338047259225131218733614434463677166702681",
            "3673432376839856069755367057023424928792306328534141955509",
            "7812608944201450747030879622908459727217167416946166192536",
            "7819406122638004023488167429929165078448169462226034130090"
        }, "dp9");
        
        joinResults(new String[] {
        "6417314233104682472433625851929053118425883130614408759673",
            "135276288633582664199692083473082286052414415973064248323",
            "8475677224292460298540058031471816589523978551630486362529",
            "9044804426365258289986989638599963618832035664653107397363",
            "1035334769150739330182792087356750051575092238605667652179"
        }, "dp10");
        
         
        joinResults(new String[] {
        "10846797209365837045476617690805073228667941889255805625872",
            "12302462363571443657459021217037771152496237803455727475837",
            "3867371203798379359315847325469722426315103196783736194461",
            "11515024441415965922646561811124678476911247480684879465685",
            "11685158664941820125788267341224086044428292318498706293651"
        }, "dp11");
        
        joinResults(new String[] {
        "7100012115900401859552545796780310685635642733223049869948",
            "2535395138008405189456039006109958058591515918058256706663",
            "9406154241660877508278273879818793166313416584706677553644",
            "7246621068811413430517091414004387429784480342991866478397",
            "11374427847938986595210786442532549156289055008080694198711"
        }, "dp12");
        
        joinResults(new String[] {
        "2666932896835853097364504419319689047856223236155837038783",
            "11622415478230321546904668488302908072690456482957944778884",
            "6381415870951805410433923542806547413790997064953505143725",
            "6007134560507196298426370986327365853647202632750252048178",
            "10984711605794908229885269102489488108629224990372282729383"
        }, "dp13");
        
        joinResults(new String[] {
        "7196525721182753772754195043582958910139874347636665009793",
            "5739941598587993430541537520542349472063815666302475064424",
            "1538004311225842135278081014078017538366042130563469451459",
            "8651323360469109299716057623675993336653422341797086284093",
            "1982611950081024417053286490951346407186218452420962101948"
        }, "dp14");
                         
        joinResults(new String[] {
        "10334973124186757228109129764639442928062128074037153904567",
            "6340735749086593715163689709854149706621789265247783211236",
            "890430019883165385273509095823090735557071211743689831929",
            "9322205261854591057584935168908330433291607323643905599576",
            "10774266257308977196883472800020984693081486217667005964640"
        }, "dp15");
        
        joinResults(new String[] {
        "9988735269638598319029600080455327631360119287239305583901",
            "8203318409318537499357899762835102689266677324421757337627",
            "8222373665841779662636594224589647763657544617424360657198",
            "10954897541553219678325521044398647106465349950293099516666",
            "293285525967949423665121426967273305864431667671585276415"
        }, "dp16");
        
        joinResults(new String[] {
        "4734864045214258659375071193022244548727368488669723894630",
            "2794596368346231939978374573154495659208943782179615534361",
            "11306970700223225818185186782917202375283963272847065357625",
            "11907384654706609296748564393064333129414163088562216742373",
            "6918794643829758868727539597087722783979685103052000355940"
        }, "dp17");
        
        joinResults(new String[] {
        "5374727701533749401388576450479771723733741464125262802516",
            "12370688706595058877914661291433263080069584883236771753826",
            "3060128518756914858797880107763288640842973279558417992226",
            "11845421713061777567691363024582730194726419753542860268034",
            "5011643772372583877222255664986944857241382554223703135830"
        }, "dp18");
        
        joinResults(new String[] {
        "4582239908520790325059773701150498719151011782660510144726",
            "7381811977276035833912085023780266185480095453321524919721",
            "5634014652146894459412248284070926570365510988927559047425",
            "460775423086012358047824252286207825133732421160291339264",
            "7049564980516990078911226431542766364279068661794947392727"
        }, "dp19");
        
        joinResults(new String[] {
        "11371799913893880022876933748177703165442768773516056778893",
            "6406062505531898103433642230879084401523678947285665304221",
            "8193603180753492943225058370667063430734872380436369860721",
            "887757277959456606467177523912359869097651024175076795062",
            "10803387534181356907011924665609787629815158867134254151743"
        }, "dp20");
                 
            
        joinResults(new String[] {
        "3686420528351362353815949575093813827037442311545764536379",
            "12150526585651334362935596706556332905026319340532294566968",
            "737319523773147809713220461289194480157095818108936628209",
            "2798382586477614062134868308047342376811000189116006899708",
            "5735757717293264466743522641843982075377561824925053942903"
        }, "dp21");
        
        joinResults(new String[] {
        "4248091329089394813452803638856451720044275048575864505909",
            "1750219955715099572669364220794258629768879295238398780976",
            "9714646937093762500677921392135839344338064791601867102169",
            "5945472150166237220189629624927909653221191787444792478478",
            "3449976569482228948353438816116206317037002882337112873158"
        }, "dp22");
        
        joinResults(new String[] {
        "9076799103674034360910159592531053458098981367900917129861",
            "5434087570891497068562362444572725562044709554565503589399",
            "9462156615616929183937276093657174986929644314001362204420",
            "10211556348945874995432983641158079909077150752709666729685",
            "3478010773191748974171954767326964580463637986242350339867"
        }, "dp23");
        
        joinResults(new String[] {
        "611514616978078234541957935086649589451914015133246840580",
            "8118075851412542451410312304154396727705371075735758288472",
            "1357629386877857758071988270271576338943240788451570240910",
            "1202133701748856354666853661382597849451604934718242863878",
            "1264849913756026728980466675520112326652569850670789936885"
        }, "dp24");
         
        joinResults(new String[] {
        "10007474628162789485026391748849523040452354908331437404081",
            "9964966908654869235564153798726374367013524811911899194509",
            "5747985553431364366981259587876975818338102704406546477572",
            "2973462236022947339291655853434035655474760616412200009949",
            "8968721086048114156151275550359089615335384181402255195927"
        }, "dp25");
        
        joinResults(new String[] {
        "2934086478144450292949131480800562893249174655864429943055",
            "5871221504885419959589773104203444642676730354588444308246",
            "1456793564239342294230264104974765941815131036347964498863",
            "470469300402581486352178744593149492131436545513110661507",
            "1821632623101567494550231411843409862332232536610356274063"
        }, "dp26");

        joinResults(new String[] {
        "10724325727097942794661977056968683528689592500667078426400",
            "3823995507733633593770550608326401082934807712651864078795",
            "11371397141411036480917848925589220577890800411154640235275",
            "11703057402390379176124979734912086225686215754396481042137",
            "39834633687092537539380213449607081412713767967265664474"
        }, "dp27");
        
        joinResults(new String[] {
        "1561486052693575750727456795055577299247413830781999037282",
            "215988583096548923492453670672292098596117906094265229116",
            "3412639500191644533604250499661440721011960811757603143118",
            "2606336494028749328158949380394959872556485659740911959420",
            "4757752840762842991688468500631062840792730375267549807572"
        }, "dp28");
        
        joinResults(new String[] {
        "4690756133267441982208373965021636559219015168989653055950",
            "6908132400611781195521933879524587645614175853280353072451",
            "12437963446154705614245922420540822782297204314966797207446",
            "8652427554939675374288709191639199211349444781157146301150",
            "4973330877346480416749797082519752298134289652222645679271"
        }, "dp29");
        
        joinResults(new String[] {
        "6237575537063107859838494966891006897923135023863027212396",
            "11268937121141191529404795871940795260629573229962751947158",
            "6505982031195689711782136796474558675433036894026437343874",
            "11639314939434680748365422456572890378163407172593554675661",
            "2010800783485414733911270931092257205189899774920178245201"
        }, "dp30");
        
        joinResults(new String[] {
        "680564733841876909638059361598621363396",
            "195411107681687300586752",
            "313040665184000030240324",
            "686588348146452273586892",
            "1281228595574592254427336"
        }, "a30");
        
        joinResults(new String[] {
        "9861383686353564066560298082354259326076898159491315747138",
            "12198492605058465970003630528866889862510328535590379692091",
            "1241358345349831032583632219895789226835457684304722273408",
            "5552474417631870858321263654352185235436658901914758487054",
            "8808901357926352655545912053776868696983163844235090908930"
        }, "b30");
        
        joinResults(new String[] {
        "6712737116541892666006810795467678634931240042768695635903",
            "857520038717537452059666283450967178046097938074499528276",
            "12094138531024545779025145398641988346909583654544379262417",
            "6821277281091685990521856285765054188260842797046575521674",
            "11176937444944422695688642259645820069191853876649642122117"
        }, "AX");
        
        
        BigInteger a = realToZq(-5.0);
        BigInteger b = realToZq(2.0);
        
        BigInteger c = a.multiply(b).mod(q);
        System.out.println("pow2f:" + pow2f);
        System.out.println("c:" + c);
        System.out.println("c.divide:" + c.divide(pow2f));
        
        BigDecimal cReal = ZqToReal(c.divide(pow2f));
        System.out.println("cReal:" + cReal);
        
        System.out.println("c post converting to real:" + ZqToReal(c).divide(BigDecimal.valueOf(2).pow(f)));
        
        joinResults(new String[] {
        "11145617681849884613214416928754509118898269620550782739017",
            "12194958515234144836195054969971270708428102839898949472752",
            "9347900739628060138530953131786303309089351375763014805062",
            "4908234695923121838173903660813968552883693567688425255838",
            "65898779684873156900407847919946807314455398635460139510"
        }, "beta0");
        
        joinResults(new String[] {
        "4075037989041467678750876442508669222494802627290897789575",
            "10098909959529157006565864399718395468446507683811765965866",
            "9136808187194888632849987884941308389224458259823432000480",
            "10271708214180381329566547397987951890949416608171469614039",
            "4080146062374189935281460414089673525499538887034241033494"
        }, "beta1");
        
        joinResults(new String[] {
        "4927603453641723775544236058974805751979350936478630111607",
            "7370571084984260923010677523504247709132799155835771902492",
            "4921213325666594627601823022241092263852293839405097778882",
            "8965664134611597004134390209892036724938891165555469768525",
            "11477558413415908252723609724633816046712898843971345752933"
        }, "beta2");
       
        joinResults(new String[] {
        "152660558773431921410077479219028486172837920304976741990",
            "3901647520998689686844143296455279870589060822457004245185",
            "1492361550731348410897916868258946841028438719844498654907",
            "4227453249685385467682782738155232960800701734804908595397",
            "2780080590584506040836658464326844673616814573301148902898"
        }, "beta3");

        joinResults(new String[] {
        "3577296793080614887616685277594691971462144445728772338660",
            "7383939373318585095899948360063745213289615714559190423749",
            "3971976173156320122419397540466231555301837905044315445278",
            "5258206927088163349583158348162322291423894846955989615193",
            "4916987674903039599823968166543674632931967448442648088040"
        }, "beta4");

        joinResults(new String[] {
        "1737731766316936227999093289328857301764693174243297998635",
            "3652382475274998633179654891726570280434910403362183131209",
            "10870004445921797028786312852630428941839818298659252119252",
            "1593996043891659630288868415671006618887264189041502188113",
            "7254292210141331535089228243473802521481851132733935561886"
        }, "beta5");

        joinResults(new String[] {
        "4194848223391461688477246551160548681975636743197448157347",
            "8945727365097408927307299118703085626955832604678436222726",
            "948343464410767475132867463802380910621106326504871606971",
            "9213713591277578005935999361487474322000786443608417411598",
            "1805774297369506958489745197677176122856046529901265252871"
        }, "beta6");
        
        joinResults(new String[] {
        "1696854561284650998094521581489897349721371318776258520913",
            "5540049625633915812710904615348717537265079544741766137548",
            "11715868271455644253846025498529203398669799761908284836569",
            "1023599889557920703429748270644357290015653605391798093197",
            "5132034593614591287261957726818490088737858864746449649174"
        }, "beta7");

        joinResults(new String[] {
        "7746997694179838344930728829965636997901319098127407094106",
            "4445190798666381918570713779496786874281938802829696349100",
            "7079878442013377305494031823153655795897615343259928502236",
            "11373507525138107421155928819129678366701848437621027967461",
            "7017035952322379592863333287500240461833051105346658209935"
        }, "beta8");
        
        joinResults(new String[] {
        "10842495958500435213737684033486024793071780320264250375472",
            "11229312711159661812616824636660243752693099030788729835901",
            "12270654360965361179496356749955950578380060970263190872299",
            "4834682016382011950546015293330669952740858355013036934676",
            "11039668836085975954289434672228442251931981761697268439524"
        }, "beta9");

        joinResults(new String[] {
        "2933259168954981356598210984452452620844895259581974503388",
            "8342154692677375209927499278292048487882307206480439115987",
            "7543909852956847294113040718381126440985547875299117688743",
            "8333242999390508821808975178617929841790916865337034632719",
            "10510043698340371900567010379502441105112131820824973515611"
        }, "beta10");
        
        joinResults(new String[] {
        "8891737870144100218049485073339483427788249859380868762172",
            "3513234470711377384672327651857872456673087331315762742754",
            "389783807434971983071702795890363957083053188553109985827",
            "5168270942598006519582335982174357877106017141620639123710",
            "7145379850658266949967306189568587945758142374252825496681"
        }, "beta11");
        
        joinResults(new String[] {
        "5492757754745437500126982855045459389062058993212087353275",
            "5538490741958290655262118371044342968775423100485377643260",
            "7022242177381227618643668730791192570804627369714748737678",
            "7952880497566727616692532937423503723235848596837943094546",
            "11656239240668401192289433644941499844736600075496782570157"
        }, "beta12");
        
        joinResults(new String[] {
        "6198382784395667194219980235310356970163834556896379723776",
            "7928574497759838740801948295989962116869310857455694716225",
            "5471451688067932292672129321964976774044803540709051869279",
            "5688934351246130085307876530590843544974867730364458641477",
            "12375267090850516270012802155389859090560155692122552587463"
        }, "beta13");
        
        joinResults(new String[] {
        "6551889237060186825460763339231282403133141215214561829148",
            "4209694310303579285856644113024680888007653469964454256403",
            "4034709881990393672187905780640581026723768015698860503364",
            "12112640776140798466445226345243793744613777743677920368959",
            "10753676206825126333064196961105660434136436992812948753352"
        }, "beta14");
        joinResults(new String[] {
        "8572490699849395824521522416033089616235201254863848248712",
            "6866351016411921691420515205525337034012537599551762222780",
            "6052498815415027165600582147908396101849214746512223654332",
            "3467554006162792564382582096526409496727202700449937054795",
            "149512403707585809417955826837433415583473136406466709935"
        }, "beta15");
        
        joinResults(new String[] {
        "6903015334586545941591149347266434378624971527924233924489",
            "11127703656823033765876977881371344080256257637703595631231",
            "11788956554655761865033007310072293799733116912710390622004",
            "494703716595827303998435349000262880154782791008080870952",
            "7348231149658915706515166651535663357844839542546366460506"
        }, "beta16");
        
        joinResults(new String[] {
        "6980205254144951188035772167974894009696743956841516727642",
            "12551660794168606304339466666174917871794941923135918122967",
            "11914387368406432730561599703760250012755236650405706526836",
            "6892218631807345674952662168783507818228374494326960987364",
            "11878341834566110212796814678967761616343489503682233793453"
        }, "beta17");
        
        joinResults(new String[] {
        "11416335080442653245478990409526022839686901594737898781796",
            "4959993533332233387737175276617270024517098725772323768134",
            "11495215723578098810995799178556580495650408874654326695048",
            "5005092592742070100881121975040601276670954541190815733756",
            "4785973482225029037921649699505523860089704209290276011836"
        }, "beta18");
        joinResults(new String[] {
        "9067417015309193412346946058234117404786455987304895835734",
            "10208607192731488625775465695480609419481523971704452545013",
            "3247680961864146369876276371498945657922769870229866744137",
            "10681898205364295651836712197364989707532952112152771969945",
            "4457007037050960523179336216667336306890339598536144170949"
        }, "beta19");



        joinResults(new String[] {
        "6942661813704666532375976231363525372179490398388002186721",
            "988988840742499573024897780333281515047311348295465034192",
            "10253871207905384092735498566489054439243730753351504695290",
            "549758575695432725589288201364005194501016682567446392341",
            "6373126503498740131617496913280799143439016748068245151638"
        }, "beta20");
        
        joinResults(new String[] {
        "1621982991265105128108791606792695988579464714013838244357",
            "8746323290211442679613331817728001288427820280998644527377",
            "3179551907666489195766046498414001419548502889779353914756",
            "3935541776544710683625611431127109105220390818877685278588",
            "7625006975858975368229376338768857862631843277832025084866"
        }, "beta21");
        
        joinResults(new String[] {
        "4342948793398144865216731328649347906117385684040551239795",
            "1681493729661625089055260296922421331865445878478311083291",
            "10623140769509652275921337340345008599063159556188078313339",
            "3434558568830297619373680849257195708808096556844276326346",
            "5026265080147003205776147877656692118553314093587642117178"
        }, "beta22");
        joinResults(new String[] {
        "12470316593811787629431220307623332102260620018191636182125",
            "1592653121258424710329742844280386480106233854301931039794",
            "4959169125298690397392375548827706405057335203004037418188",
            "10197627768815496010607168734744795162145282172329970646777",
            "8442843803135685835254229103769778347043607703742957977462"
        }, "beta23");
        
        joinResults(new String[] {
        "11493955617616786311384315642225816892495232530994643212713",
            "4493510401196094785823585687413494774036169923914750556012",
            "2454147971620426430463967152425161177595523133606716632063",
            "10989298372091469383767229932101992068624959420638628037172",
            "8231698049795307671575638125079533583861998098740549488222"
        }, "beta24");


        joinResults(new String[] {
        "1179385784562256307213658705590154787727547074920436391004",
            "2469083810302272169399888122625009863228962729416721282817",
            "5993540535675522252898212412005975743297040761446234500553",
            "647410431125947611815256520306393590111714679893578566537",
            "2264782909107363186344563085887798847839180501768024136397"
        }, "beta25");
        
        joinResults(new String[] {
        "11725966161492325587650604458812106127135041837344611259736",
            "3189505381752214879652392130855265489829210402058196534769",
            "3277569230281972855767258975462528301534946651432743663435",
            "11771212520716566571245479020523082259074499867648230531758",
            "7698357118077004688699001953593016319039579625713661517181"
        }, "beta26");
        
        joinResults(new String[] {
        "2955034752479868647199612304650628036298726881094295048709",
            "9995336152009516498046539895465060041225208802251819517509",
            "5700924308038958705497480432762438916878942549734793602054",
            "7114237045983778972385091219551506900807202565105395567935",
            "11897078153807961759886012686816364601404109749523841675602"
        }, "beta27");
        
        joinResults(new String[] {
        "12234378899035485459602410751324755689188681412186115766235",
            "4223331571790455839398937406140861789339014990466025878286",
            "1966734584480399096314699734307203403908601265412948506061",
            "9424144985390977340686610982152980276010090428022740965577",
            "9814020371622766847012077665320197338168458799625396162115"
        }, "beta28");
        
        joinResults(new String[] {
        "8818281225094336722718107301491508377881648278908040544035",
            "5984020767659152842342125084908533225527203239644622325041",
            "3857192560070881650256434575273948263830054208686454632469",
            "10100323497991328932960831586467069459483514426102442570927",
            "8902792361504384434737237991104939169891113464719771303533"
        }, "beta29");
        
        
        
        
        
        
        
        
        joinResultsAndTruncate(new String[] {
        "11455390839554848981103163466444184758158973632960749519075",
            "2461389078593128562635132298349033501172157307639437324575",
            "8216389954830298097899239366750823494582141263489970237118",
            "12324926399576577928759683394316377740165788821519652582876",
            "3204514139765231016528530127389693124064019113543857589892"
        }, "prediction");
        
        
    }
    
    private static void joinResults(String val0, String val1, String varName) {
        BigInteger beta0 = new BigInteger(val0);
        BigInteger beta1 = new BigInteger(val1);
        
        BigDecimal beta = ZqToReal(beta0.add(beta1).mod(q));
        System.out.println(varName + ":" + beta);
    }
    
    private static void joinResults(String[] vals, String varName) {
        
        BigInteger beta = BigInteger.ZERO;
        
        for(String val: vals) {
            beta = beta.add(new BigInteger(val)).mod(q);
        }
        
        //System.out.println(varName + " in bigint:" + beta);
        BigDecimal result = ZqToReal(beta);
        System.out.println(varName + ":" + result);
    }
    
    public static BigDecimal ZqToReal(BigInteger x) {
        BigInteger partition = q.subtract(BigInteger.ONE)
                .divide(BigInteger.valueOf(2));
        BigInteger inverse = BigInteger.valueOf(2).pow(f);
        BigDecimal Zk;
        
        // If x is more than half of the field size, it is negative.
        if (x.compareTo(partition) > 0) {
            Zk = new BigDecimal(x.subtract(q));
        } else {
            Zk = new BigDecimal(x);
        }

        BigDecimal Q = Zk.divide(new BigDecimal(inverse), f, 
                RoundingMode.CEILING);
        return Q;
    }
    
    /**
     * convert a decimal value to over Zq
     * @param x value in reals
     * @param f bit resolution of decimal component
     * @param q
     * @return BigInteger of x in Z_q
     */
    public static BigInteger realToZq(double x) {
        // Our integer space must be at least 2^k
        BigDecimal X = BigDecimal.valueOf(x);
        BigDecimal fac = BigDecimal.valueOf(2).pow(f);
        X = X.multiply(fac);

        return X.toBigInteger().mod(q);
    }

    private static void joinResultsAndTruncate(String[] vals, String varName) {
        BigInteger beta = BigInteger.ZERO;
        
        for(String val: vals) {
            beta = beta.add(new BigInteger(val)).mod(q);
        }
        
        BigDecimal result = ZqToReal(beta.divide(pow2f));
        System.out.println(varName + ":" + result);
        
    }
}
